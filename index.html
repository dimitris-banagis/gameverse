document.addEventListener("DOMContentLoaded", function() {
    loadGameData();
    generateGames(2000); // Δημιουργεί τα 2000 παιχνίδια
});

function generateGames(numGames) {
    const container = document.getElementById('games-container');
    
    for (let i = 1; i <= numGames; i++) {
        const gameDiv = document.createElement('div');
        gameDiv.classList.add('game');
        gameDiv.setAttribute('data-game-id', i);
        
        const gameTitle = document.createElement('h2');
        gameTitle.textContent = `Παιχνίδι ${i}`;
        
        const rateBtn = document.createElement('button');
        rateBtn.textContent = "Βαθμολογήστε";
        rateBtn.onclick = () => rateGame(i);
        
        const commentsSection = document.createElement('div');
        commentsSection.classList.add('comments-section');
        commentsSection.innerHTML = `
            <h3>Σχόλια:</h3>
            <ul id="comments-${i}"></ul>
            <input type="text" id="comment-input-${i}" placeholder="Γράψε το σχόλιο σου...">
            <button onclick="addComment(${i})">Προσθήκη Σχολίου</button>
        `;
        
        const ratingDiv = document.createElement('div');
        ratingDiv.classList.add('rating');
        ratingDiv.innerHTML = `
            <p>Βαθμολογία: <span id="rating-${i}">0</span>/5</p>
        `;
        
        gameDiv.appendChild(gameTitle);
        gameDiv.appendChild(rateBtn);
        gameDiv.appendChild(commentsSection);
        gameDiv.appendChild(ratingDiv);
        
        container.appendChild(gameDiv);
    }
}

function loadGameData() {
    // Φόρτωμα δεδομένων (βαθμολογία και σχόλια) από το localStorage
    const games = document.querySelectorAll('.game');
    games.forEach(game => {
        const gameId = game.getAttribute('data-game-id');
        const savedRating = localStorage.getItem(`rating-${gameId}`);
        const savedComments = JSON.parse(localStorage.getItem(`comments-${gameId}`)) || [];
        
        // Εμφανίζουμε τη βαθμολογία
        if (savedRating) {
            document.getElementById(`rating-${gameId}`).textContent = savedRating;
        }
        
        // Εμφανίζουμε τα σχόλια
        savedComments.forEach(comment => {
            const li = document.createElement('li');
            li.textContent = comment;
            document.getElementById(`comments-${gameId}`).appendChild(li);
        });
    });
}

function rateGame(gameId) {
    const rating = prompt("Βάλε βαθμολογία (1-5):");
    
    if (rating >= 1 && rating <= 5) {
        // Αποθήκευση της βαθμολογίας
        localStorage.setItem(`rating-${gameId}`, rating);
        document.getElementById(`rating-${gameId}`).textContent = rating;
    } else {
        alert("Η βαθμολογία πρέπει να είναι μεταξύ 1 και 5.");
    }
}

function addComment(gameId) {
    const commentInput = document.getElementById(`comment-input-${gameId}`);
    const commentText = commentInput.value;
    
    if (commentText.trim() === "") {
        alert("Παρακαλώ γράψε ένα σχόλιο.");
        return;
    }
    
    // Αποθήκευση του σχολίου
    const savedComments = JSON.parse(localStorage.getItem(`comments-${gameId}`)) || [];
    savedComments.push(commentText);
    localStorage.setItem(`comments-${gameId}`, JSON.stringify(savedComments));
    
    // Εμφάνιση του σχολίου
    const li = document.createElement('li');
    li.textContent = commentText;
    document.getElementById(`comments-${gameId}`).appendChild(li);
    
    // Καθαρισμός του πεδίου σχολίου
    commentInput.value = "";
}

function searchGames() {
    const query = document.getElementById('searchBar').value.toLowerCase();
    const games = document.querySelectorAll('.game');
    
    games.forEach(game => {
        const title = game.querySelector('h2').textContent.toLowerCase();
        if (title.includes(query)) {
            game.style.display = '';
        } else {
            game.style.display = 'none';
        }
    });
}
